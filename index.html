<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meow Adventure - Start</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            font-family: 'Press Start 2P', cursive;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #f0f2f5; /* Outer background */
        }

        #start-box {
            width: 900px;  /* INCREASED WIDTH */
            height: 600px; /* INCREASED HEIGHT */
            padding: 30px; /* Adjust padding for larger box */
            background-color: #ffe0b2; /* Or your peach: #FFDAB9 */
            /* --- THIS IS THE BORDER STYLE --- */
            border: 8px solid #6d4c41; /* Slightly thicker border for larger size */
            border-radius: 20px;       /* Slightly larger radius */
            box-shadow: 0 0 0 5px #a1887f, /* Inner shadow border */
                        0 6px 18px rgba(0,0,0,0.3); /* Outer shadow */
            /* --- END BORDER STYLE --- */
            position: relative;
            display: flex;
            align-items: center;
            gap: 25px; /* Adjust gap */
            overflow: hidden;
            box-sizing: border-box;
        }

        /* Left Column for Logo */
        #logo-column {
            flex: 0 0 280px; /* Adjust width for logo column in larger box */
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #game-logo {
            max-width: 100%;
            max-height: 85%;
            object-fit: contain;
            image-rendering: pixelated;
            background-color: #fff;
            border: 4px solid #a1887f;
            border-radius: 10px;
            padding: 15px; /* Adjust padding */
            box-shadow: 0 3px 6px rgba(0,0,0,0.15);
        }

        /* Right Column for Text and Button */
        #text-column {
            flex: 1;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: flex-start;
            padding-left: 20px;
        }

        #title-container {
            position: relative;
            display: inline-block;
            margin-bottom: 15px; /* Adjust spacing */
        }

        #text-column h1 {
            font-size: 2em; /* Adjust font size for larger box */
            color: #5d4037;
            margin: 0;
            line-height: 1.3;
        }

        .sparkle {
            position: absolute;
            width: 7px; /* Slightly larger sparkles */
            height: 7px;
            background-color: #f8b0c0;
            border-radius: 50%;
            opacity: 0;
            pointer-events: none;
        }

        #text-column p.subtitle {
            font-size: 0.9em; /* Adjust font size */
            color: #795548;
            margin-top: 8px;
            margin-bottom: 30px; /* Adjust spacing */
        }

        #start-button {
            font-family: 'Press Start 2P', cursive;
            padding: 12px 25px; /* Adjust padding */
            font-size: 1em; /* Adjust font size */
            background-color: #ffe0b2;
            color: #5d4037;
            border: 3px solid #6d4c41;
            border-radius: 8px; /* Slightly larger radius */
            cursor: pointer;
            box-shadow: 0 0 0 2px #a1887f, inset 0 0 0 1px #fff3e0;
            transition: transform 0.1s ease, background-color 0.1s ease;
            text-transform: uppercase;
        }
        #start-button:hover {
             background-color: #fff3e0;
             transform: translateY(-2px); /* Slightly more movement */
        }
        #start-button:active {
            transform: translateY(1px);
        }

        #sound-toggle-button {
            font-family: 'Arial', sans-serif;
            position: absolute;
            bottom: 25px; /* Adjust positioning */
            right: 25px;  /* Adjust positioning */
            width: 40px;  /* Slightly larger */
            height: 40px; /* Slightly larger */
            background-color: #c8b7a6;
            color: #6d4c41;
            border: 3px solid #6d4c41;
            border-radius: 50%;
            font-size: 1.2em; /* Adjust icon size */
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: inset 0 0 0 2px #e0d4c8;
            z-index: 10;
        }
         #sound-toggle-button:hover {
            background-color: #d7ccc8;
        }
    </style>
</head>
<body>
    <div id="start-box">
        <!-- Content as before -->
        <div id="logo-column">
            <img id="game-logo" src="images/Logo/Logo.jpg" alt="Meow Adventure Logo">
        </div>
        <div id="text-column">
            <div id="title-container">
                <h1>Meow Adventure</h1>
            </div>
            <p class="subtitle">Help a lost kitten find its way home!</p>
            <button id="start-button" data-nextscene="scene01.html">Start</button>
        </div>
        <button id="sound-toggle-button">ðŸ”‡</button>
    </div>

    <audio id="main-bg-music" src="audio/peaceful_intro.mp3" loop></audio>
    <audio id="click-sound" src="audio/ui_click.mp3"></audio>

    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script>
        // Your existing JavaScript for the start page
        // No changes needed to JS for this layout update unless GSAP animations
        // for sparkles depend heavily on exact pixel dimensions which they shouldn't if
        // they use .outerWidth()/.outerHeight() of the title container.
        $(document).ready(function() {
            const $startButton = $('#start-button');
            const $soundToggleButton = $('#sound-toggle-button');
            const mainBgMusic = $('#main-bg-music')[0];
            const clickSound = $('#click-sound')[0];
            const $titleContainer = $('#title-container');
            const $gameLogo = $('#game-logo');
            const $textColumnChildren = $('#text-column > *').not('#title-container').not($soundToggleButton);

            let isMuted = localStorage.getItem('meowAdventureMuted') !== 'false';

            function updateSoundButtonUI() { $soundToggleButton.text(isMuted ? 'ðŸ”‡' : 'ðŸ”Š'); }
            function applyMuteStateToAudioElements() {
                if (mainBgMusic) mainBgMusic.muted = isMuted;
                if (clickSound) clickSound.muted = isMuted;
            }
            function saveSoundPreference() { localStorage.setItem('meowAdventureMuted', isMuted); }
            function playMainMusic() {
                if (mainBgMusic && !isMuted && mainBgMusic.paused) {
                    mainBgMusic.play().catch(error => console.warn("BG music play failed:", error));
                }
            }
            function pauseMainMusic() { if (mainBgMusic && !mainBgMusic.paused) mainBgMusic.pause(); }

            if (mainBgMusic) mainBgMusic.volume = 0.2;
            if (clickSound) clickSound.volume = 0.5;
            applyMuteStateToAudioElements();
            updateSoundButtonUI();

            $soundToggleButton.on('click', function() {
                isMuted = !isMuted;
                applyMuteStateToAudioElements();
                updateSoundButtonUI();
                saveSoundPreference();
                if (!isMuted) {
                    playMainMusic();
                    if (clickSound) {
                        clickSound.muted = false;
                        clickSound.currentTime = 0;
                        clickSound.play().catch(e => console.warn("Click sound error for toggle: ", e))
                                   .finally(() => { if (clickSound) clickSound.muted = isMuted; });
                    }
                } else { pauseMainMusic(); }
            });

            $startButton.on('click', function() {
                if (!isMuted && clickSound) {
                    clickSound.currentTime = 0;
                    clickSound.play().catch(e => console.warn("Click sound error on start: ", e));
                }
                playMainMusic();
                sessionStorage.setItem('meowAdventureMuted', isMuted);
                if (mainBgMusic && !mainBgMusic.paused && !isMuted) {
                    sessionStorage.setItem('musicTime', mainBgMusic.currentTime);
                    sessionStorage.setItem('musicSrc', mainBgMusic.src);
                    sessionStorage.setItem('musicPlaying', 'true');
                } else { sessionStorage.setItem('musicPlaying', 'false'); }
                gsap.to('#start-box', {
                    autoAlpha: 0, scale: 0.9, duration: 0.4, ease: "power1.in",
                    onComplete: function() { window.location.href = $startButton.data('nextscene'); }
                });
            });

            const numSparkles = 12; // A few more sparkles for larger title
            for (let i = 0; i < numSparkles; i++) { $titleContainer.append('<div class="sparkle"></div>'); }
            const $sparkles = $('.sparkle');
            // Ensure titleContainer is laid out before getting its dimensions for sparkles
            gsap.delayedCall(0.05, () => { // Small delay to ensure DOM is ready
                gsap.set($sparkles, {
                    x: () => gsap.utils.random(-$titleContainer.outerWidth() * 0.15, $titleContainer.outerWidth() * 1.15),
                    y: () => gsap.utils.random(-$titleContainer.outerHeight() * 0.5, $titleContainer.outerHeight() * 1.3),
                    scale: () => gsap.utils.random(0.5, 1.1)
                });
                gsap.to($sparkles, {
                    opacity: gsap.utils.random(0.4, 0.9, true), duration: 0.6,
                    stagger: { each: 0.12, repeat: -1, yoyo: true, ease: "sine.inOut" },
                    scale: () => gsap.utils.random(0.3, 0.8), delay: 0.8
                });
            });


            gsap.from($gameLogo, { duration: 0.8, x: -100, opacity: 0, ease: "power2.out", delay: 0.2 });
            gsap.from($titleContainer, {duration: 0.7, x: 60, opacity:0, ease:"power2.out", delay: 0.4});
            gsap.from($textColumnChildren, {
                duration: 0.6, x: 60, opacity: 0, ease: "power2.out", stagger: 0.15, delay: 0.65
            });
            gsap.from($soundToggleButton, { duration: 0.6, opacity: 0, scale:0.3, ease:"back.out(1.7)", delay: 1.1 });

            $(window).on('beforeunload', function() {
                saveSoundPreference();
                if (mainBgMusic && !mainBgMusic.paused && !isMuted) {
                    sessionStorage.setItem('musicTime', mainBgMusic.currentTime);
                    sessionStorage.setItem('musicSrc', mainBgMusic.src);
                    sessionStorage.setItem('musicPlaying', 'true');
                } else { sessionStorage.setItem('musicPlaying', 'false'); }
            });
        });
    </script>
</body>
</html>