<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meow Adventure - Start</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sour+Gummy:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            font-family: "Sour Gummy", sans-serif; /* Global font application */
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #f0f2f5;
        }

        #start-box {
            width: 900px;
            height: 600px;
            padding: 30px;
            background-color: #ffe0b2; /* This is the light peach/tan from your screenshot */
            border: 8px solid #604030; /* Darker brown border from screenshot */
            border-radius: 25px;       /* More rounded corners from screenshot */
            box-shadow: 0 0 0 5px #8c6d52, /* Inner shadow border, slightly lighter brown */
                        0 8px 20px rgba(0,0,0,0.25); /* Softer outer shadow */
            position: relative;
            display: flex;
            align-items: center;
            gap: 30px; /* Increased gap slightly */
            overflow: hidden;
            box-sizing: border-box;
        }

        /* Left Column for Logo */
        #logo-column {
            flex: 0 0 280px; /* Adjust width for logo column in larger box */
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #game-logo {
            max-width: 100%;
            max-height: 85%;
            object-fit: contain;
            image-rendering: pixelated;
            background-color: #fff;
            border: 4px solid #a1887f;
            border-radius: 10px;
            padding: 15px; /* Adjust padding */
            box-shadow: 0 3px 6px rgba(0,0,0,0.15);
        }

        /* Right Column for Text and Button */
        #text-column {
            flex: 1;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: flex-start; /* Align text to the left */
            padding-left: 25px; /* More padding from the logo */
        }

        #title-container {
            position: relative;
            display: inline-block; /* So sparkles are relative to text width */
            margin-bottom: 20px; /* Increased space below title */
        }

        #text-column h1 { /* Game Title */
            font-family: "Sour Gummy", sans-serif; /* Ensure it's applied */
            font-size: 3.5em;  /* INCREASED: Significantly larger title, e.g., ~56px if base is 16px */
            font-weight: 700;  /* BOLD: Make title prominent */
            color: #4a2c2a;    /* Darker brown for title text from screenshot */
            margin: 0;
            line-height: 1.2;  /* Adjust line height for larger font */
            letter-spacing: 0.5px; /* Optional: slight letter spacing if font feels too tight */
        }

        .sparkle {
            position: absolute;
            width: 5px; /* Adjust sparkle size if needed */
            height: 5px;
            background-color: #ffb6c1; /* Light pink sparkles from screenshot */
            border-radius: 50%;
            opacity: 0;
            pointer-events: none;
        }

        #text-column p.subtitle { /* Subtitle text */
            font-family: "Sour Gummy", sans-serif;
            font-size: 1.4em;  /* INCREASED: Larger subtitle, e.g., ~22px */
            font-weight: 500;  /* MEDIUM: Clearer than regular for this font */
            color: #5c3c38;    /* Slightly lighter brown for subtitle from screenshot */
            margin-top: 0px; /* Reduced space from title */
            margin-bottom: 35px; /* Increased space before button */
            line-height: 1.5;
        }

        #start-button { /* Start Button */
            font-family: "Sour Gummy", sans-serif;
            font-size: 1.5em;  /* INCREASED: Larger button text, e.g., ~24px */
            font-weight: 600;  /* SEMI-BOLD: Make button text stand out */
            color: #4a2c2a;    /* Darker brown text on button */
            background-color: #f5e6d3; /* Light creamy color for button background from screenshot */
            border: 3px solid #604030; /* Darker brown border for button */
            border-radius: 12px; /* More rounded button corners */
            padding: 12px 35px; /* INCREASED: More padding for larger text */
            cursor: pointer;
            box-shadow: 0 3px 0 0 #8c6d52, /* Button "depth" shadow */
                        inset 0 1px 2px rgba(255,255,255,0.3); /* Subtle inner highlight */
            transition: transform 0.1s ease, box-shadow 0.1s ease, background-color 0.1s ease;
            text-transform: uppercase; /* START (all caps like screenshot) */
        }
        #start-button:hover {
             background-color: #fff3e0; /* Slightly lighter on hover */
             transform: translateY(-2px);
             box-shadow: 0 5px 0 0 #8c6d52, inset 0 1px 2px rgba(255,255,255,0.3);
        }
        #start-button:active {
            background-color: #f0eadf;
            transform: translateY(1px);
            box-shadow: 0 1px 0 0 #8c6d52, inset 0 1px 2px rgba(255,255,255,0.3);
        }

        #sound-toggle-button {
            font-family: 'Arial', sans-serif; /* Keep system font for icon clarity */
            position: absolute;
            bottom: 25px;
            right: 25px;
            width: 42px; /* Slightly larger icon */
            height: 42px;
            background-color: #d3b8ae; /* Tan background for sound icon from screenshot */
            color: #604030; /* Dark brown icon symbol */
            border: 3px solid #604030; /* Dark brown border */
            border-radius: 50%;
            font-size: 1.3em;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: inset 0 0 0 2px rgba(255,255,255,0.2), 0 2px 3px rgba(0,0,0,0.2); /* Inner highlight and outer shadow */
            z-index: 10;
        }
         #sound-toggle-button:hover {
            background-color: #e0c8bf;
        }
    </style>
</head>
<body>
    <div id="start-box">
        <div id="logo-column">
            <img id="game-logo" src="images/Logo/Logo.jpg" alt="Meow Adventure Logo">
        </div>
        <div id="text-column">
            <div id="title-container">
                <h1>Meow Adventure</h1>
            </div>
            <p class="subtitle">Help a lost kitten find its way home!</p>
            <button id="start-button" data-nextscene="scene01.html">Start</button>
        </div>
        <button id="sound-toggle-button">ðŸ”‡</button>
    </div>

    <audio id="main-bg-music" src="audio/peaceful_intro.mp3" loop></audio>
    <audio id="click-sound" src="audio/ui_click.mp3"></audio>

    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script>
        // Your existing JavaScript for the start page
        // The GSAP sparkle animation code should still work fine,
        // as it calculates positions based on the #title-container's dimensions.
        // If sparkles look off, you might adjust their random positioning multipliers slightly.
        $(document).ready(function() {
            const $startButton = $('#start-button');
            const $soundToggleButton = $('#sound-toggle-button');
            const mainBgMusic = $('#main-bg-music')[0];
            const clickSound = $('#click-sound')[0];
            const $titleContainer = $('#title-container');
            const $gameLogo = $('#game-logo');
            const $textColumnChildren = $('#text-column > *').not('#title-container').not($soundToggleButton);

            let isMuted = localStorage.getItem('meowAdventureMuted') !== 'false';

            function updateSoundButtonUI() { $soundToggleButton.text(isMuted ? 'ðŸ”‡' : 'ðŸ”Š'); }
            function applyMuteStateToAudioElements() {
                if (mainBgMusic) mainBgMusic.muted = isMuted;
                if (clickSound) clickSound.muted = isMuted;
            }
            function saveSoundPreference() { localStorage.setItem('meowAdventureMuted', isMuted); }
            function playMainMusic() {
                if (mainBgMusic && !isMuted && mainBgMusic.paused) {
                    mainBgMusic.play().catch(error => console.warn("BG music play failed:", error));
                }
            }
            function pauseMainMusic() { if (mainBgMusic && !mainBgMusic.paused) mainBgMusic.pause(); }

            if (mainBgMusic) mainBgMusic.volume = 0.2;
            if (clickSound) clickSound.volume = 0.5;
            applyMuteStateToAudioElements();
            updateSoundButtonUI();

            $soundToggleButton.on('click', function() {
                isMuted = !isMuted;
                applyMuteStateToAudioElements();
                updateSoundButtonUI();
                saveSoundPreference();
                if (!isMuted) {
                    playMainMusic();
                    if (clickSound) {
                        clickSound.muted = false;
                        clickSound.currentTime = 0;
                        clickSound.play().catch(e => console.warn("Click sound error for toggle: ", e))
                                   .finally(() => { if (clickSound) clickSound.muted = isMuted; });
                    }
                } else { pauseMainMusic(); }
            });

            $startButton.on('click', function() {
                if (!isMuted && clickSound) {
                    clickSound.currentTime = 0;
                    clickSound.play().catch(e => console.warn("Click sound error on start: ", e));
                }
                playMainMusic();
                sessionStorage.setItem('meowAdventureMuted', isMuted);
                if (mainBgMusic && !mainBgMusic.paused && !isMuted) {
                    sessionStorage.setItem('musicTime', mainBgMusic.currentTime);
                    sessionStorage.setItem('musicSrc', mainBgMusic.src);
                    sessionStorage.setItem('musicPlaying', 'true');
                } else { sessionStorage.setItem('musicPlaying', 'false'); }
                gsap.to('#start-box', {
                    autoAlpha: 0, scale: 0.9, duration: 0.4, ease: "power1.in",
                    onComplete: function() { window.location.href = $startButton.data('nextscene'); }
                });
            });

            const numSparkles = 12;
            for (let i = 0; i < numSparkles; i++) { $titleContainer.append('<div class="sparkle"></div>'); }
            const $sparkles = $('.sparkle');
            gsap.delayedCall(0.05, () => {
                gsap.set($sparkles, {
                    x: () => gsap.utils.random(-$titleContainer.outerWidth() * 0.1, $titleContainer.outerWidth() * 1.1), // Adjusted multipliers for better spread
                    y: () => gsap.utils.random(-$titleContainer.outerHeight() * 0.3, $titleContainer.outerHeight() * 1.1),
                    scale: () => gsap.utils.random(0.6, 1.2) // Slightly larger sparkles
                });
                gsap.to($sparkles, {
                    opacity: gsap.utils.random(0.5, 1.0, true), duration: 0.5, // More visible
                    stagger: { each: 0.13, repeat: -1, yoyo: true, ease: "sine.inOut" },
                    scale: () => gsap.utils.random(0.4, 0.9), delay: 0.5 // Start sooner
                });
            });

            gsap.from($gameLogo.parent(), { duration: 0.8, x: -120, opacity: 0, ease: "power2.out", delay: 0.1 }); // Animate logo-column
            gsap.from($titleContainer, {duration: 0.7, x: 80, opacity:0, ease:"power2.out", delay: 0.3});
            gsap.from($('#text-column p.subtitle'), {duration: 0.6, x: 70, opacity:0, ease:"power2.out", delay: 0.5});
            gsap.from($startButton, {duration: 0.6, y: 50, opacity:0, ease:"back.out(1.4)", delay: 0.7});
            gsap.from($soundToggleButton, { duration: 0.6, opacity: 0, scale:0.3, ease:"back.out(1.7)", delay: 0.9 });

            $(window).on('beforeunload', function() {
                saveSoundPreference();
                if (mainBgMusic && !mainBgMusic.paused && !isMuted) {
                    sessionStorage.setItem('musicTime', mainBgMusic.currentTime);
                    sessionStorage.setItem('musicSrc', mainBgMusic.src);
                    sessionStorage.setItem('musicPlaying', 'true');
                } else { sessionStorage.setItem('musicPlaying', 'false'); }
            });
        });
    </script>
</body>
</html>